---
layout: post_wide
permalink: /cn/posts/mobile-app-sina-binding/
title: "手机客户端应用新浪微博绑定流程"
description: "客户端绑定微博流程 客户端一键关注微博"
category: blog
---

以网站形式接入新浪微博之后，可以调用丰富的api，实现比如，发布微博，关注公共账号等功能。

在移动客户端要实现一个一键关注公共账号的流程如下：

1. 点击关注按钮之后，app通过webview跳转到一个url，此url带上公共主页等必要参数

2. 此url对应的页面检查该用户是否有新浪微博绑定关系，如有且token没有过期，则利用token直接关注账号，否则到3.

3. 页面跳转到新浪认证绑定界面，此界面有app样式，在此界面，用户登录完成之后，页面回跳到新浪开放平台填写的回调地址，并附上code参数，用于获取token。

4. 在回调页面，获取token，执行2需要的操作。

5. 操作完成，跳转到一个自定义schema的url，客户端webview拦截每个跳转的url，发现是自定义url，告知操作成功。

步骤2和3之间，因为回调地址不允许带用户自定义参数，在步骤4需要取到步骤2的用户信息。在php中可简单用session完成。
